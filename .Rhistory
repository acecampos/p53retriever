labels(title=unique(hits$ID))
unique(hits$ID)
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.8) +
theme_bw(base_size = bs) +
labels(title=unique(hits$ID))
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.8) +
theme_bw(base_size = bs) +
labels(title=as.character(unique(hits$ID)))
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.8) +
theme_bw(base_size = bs) +
labels(main=as.character(unique(hits$ID)))
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.8) +
theme_bw(base_size = bs) +
labs(main=as.character(unique(hits$ID)))
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.8) +
theme_bw(base_size = bs) +
labs(title=unique(hits$ID))
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.8) +
theme_bw(base_size = bs) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.8,size=2*bs) +
theme_bw(base_size = bs) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.8) +
theme_bw(base_size = bs) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8)
#geom_bar(stat="identity",alpha=.8) +
theme_bw(base_size = bs) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8) +
#geom_bar(stat="identity",alpha=.8) +
theme_bw(base_size = bs) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
#geom_bar(stat="identity",alpha=.8) +
theme_bw(base_size = bs) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
#geom_bar(stat="identity",alpha=.8) +
theme_bw(base_size = bs) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.0) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.8) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
annotate fill values
bs<-16
ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.8) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
#annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
bs<-16
bp<-ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.85) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
#annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
scale_y_continuous(limits = c(0,5)) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
class(bp)
p53plot<-function(p53.table,start.at,stop.at){
bs<-16
bp<-ggplot(hits,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.85) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
#annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
scale_y_continuous(limits = c(0,5)) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
return(bp)
}
p53plot(hits,0,20000)
p53plot(hits,0,20000)
library(p53retriever)
install.packages("knitr")
data(REs.collection)
p53density(REs.collection,-10000,10000)
p53density<-function(p53.table,start.at,stop.at){
p53.table<-p53.table[which((p53.table[,"start"]>start.at)&(p53.table[,"stop"]<stop.at)),]
par(mar=c(5,5,1,1))
one<-density(rowMeans(p53.table[which(p53.table[,"grade"]>0),c("start","stop")]))
two<-density(rowMeans(p53.table[which(p53.table[,"grade"]>1),c("start","stop")]))
three<-density(rowMeans(p53.table[which(p53.table[,"grade"]>2),c("start","stop")]))
four<-density(rowMeans(p53.table[which(p53.table[,"grade"]>3),c("start","stop")]))
five<-density(rowMeans(p53.table[which(p53.table[,"grade"]>4),c("start","stop")]))
ymin<-min(c(one$y,two$y,three$y,four$y,five$y))
ymax<-max(c(one$y,two$y,three$y,four$y,five$y))
hist(rowMeans(p53.table[which(p53.table[,"grade"]>0),c("start","stop")]),breaks=((stop.at-start.at)/100),xlab="TSS relative coordinate",ylab="Probability density",main=NULL,col="grey85",border="grey85",prob=TRUE,xlim=c(start.at,stop.at), ylim=c((ymin-0.1*(ymax-ymin)),1.2*ymax),cex.axis=1.7,cex.lab=1.7)
abline(v=0,col="darkgrey",lty=2,lwd=2)
lines(one,col="grey40",lwd=3)
lines(two,col="dodgerblue",lwd=3)
lines(three,col="green3",lwd=3)
lines(four,col="indianred",lwd=3)
#lines(five,col="gold2",lwd=3)
points(p53.table[which(p53.table[,"grade"]=="5"),"start"],rep((ymin-0.05*(ymax-ymin)),length(which(p53.table[,"grade"]=="5"))),col="gold2",cex=1, pch=16, bg="gold2")
# points(p53.table[which(p53.table[,"grade"]=="4"),"start"],rep((ymin-0.1*(ymax-ymin)),length(which(p53.table[,"grade"]=="4"))),col="indianred",cex=1,pch=16)
legend("top", c(">= 1",">= 2",">= 3",">= 4", "=5"), fill=c("grey40","dodgerblue","green3","indianred","gold2"), bty="n",cex=1.5,horiz=T,title="Grade")
#legend("top", c(">= 1",">= 2",">= 3",">= 4",">= 5"), fill=c("grey40","dodgerblue","green3","indianred","gold2"), bty="n",cex=1.5,horiz=T,title="Grade")
}
p53density(REs.collection,-10000,10000)
start.at<-(-10000)
stop.at<-10000
bp<-ggplot(REs.collection,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.85) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
#annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
scale_y_continuous(limits = c(0,5)) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
library(ggplot2)
bp<-ggplot(REs.collection,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.85) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
#annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
scale_y_continuous(limits = c(0,5)) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
bs<-16
bp<-ggplot(REs.collection,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.85) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
#annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
scale_y_continuous(limits = c(0,5)) +
labs(y="Grade",x="Coordinate",title=unique(hits$ID))
bp<-ggplot(REs.collection,aes(start,grade,fill=as.factor(grade))) +
geom_bar(stat="identity",alpha=.85) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
#annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
scale_y_continuous(limits = c(0,5)) +
labs(y="Grade",x="Coordinate")
bp
bs<-16
bp<-ggplot(REs.collection,aes(start,fill=as.factor(grade))) +
geom_density(alpha=.85) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
#annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
scale_y_continuous(limits = c(0,5)) +
labs(y="Grade",x="Coordinate")
bp
bs<-16
bp<-ggplot(REs.collection,aes(start,fill=as.factor(grade))) +
geom_density(alpha=.85) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
#annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
#scale_y_continuous(limits = c(0,5)) +
labs(y="Grade",x="Coordinate")
bp
bp<-ggplot(REs.collection,aes(start,colour=as.factor(grade))) +
geom_density(alpha=.85) +
scale_colour_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
#annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
#scale_y_continuous(limits = c(0,5)) +
labs(y="Grade",x="Coordinate")
bp
devtools::use_vignette("p53retriever")
bs<-16
bp<-ggplot(REs.collection,aes(start,fill=as.factor(grade),colour=as.factor(grade))) +
geom_density(alpha=.85) +
scale_colour_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
#annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
#scale_y_continuous(limits = c(0,5)) +
labs(y="Grade",x="Coordinate")
bp
p53density(REs.collection,-10000,10000)
bs<-16
bp<-ggplot(REs.collection,aes(start,fill=as.factor(grade),colour=as.factor(grade))) +
geom_smooth(alpha=.85) +
scale_colour_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
#annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
#scale_y_continuous(limits = c(0,5)) +
labs(y="Density",x="Coordinate")
bp
bs<-16
bp<-ggplot(REs.collection,aes(start,fill=as.factor(grade),colour=as.factor(grade))) +
geom_density(alpha=.4) +
scale_colour_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
#annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
#scale_y_continuous(limits = c(0,5)) +
labs(y="Density",x="Coordinate")
bp
bs<-16
bp<-ggplot(REs.collection,aes(start,fill=as.factor(grade),colour=as.factor(grade))) +
geom_density(alpha=.2) +
scale_colour_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
#annotate("rect",xmin = hits$start, xmax = hits$stop, ymin = 0, ymax = hits$grade, alpha = .8, fill=as.factor(hits$grade)) +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
#scale_y_continuous(limits = c(0,5)) +
labs(y="Density",x="Coordinate")
bp
dp<-ggplot(p53.table,aes(start,fill=as.factor(grade),colour=as.factor(grade))) +
geom_density(alpha=.2) +
scale_colour_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
annotate("point",x = p53.table$start, y = 0, alpha = .8, colour="gold2") +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
labs(y="Density",x="Coordinate")
p53.table<-REs.collection
dp<-ggplot(p53.table,aes(start,fill=as.factor(grade),colour=as.factor(grade))) +
geom_density(alpha=.2) +
scale_colour_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
annotate("point",x = p53.table$start, y = 0, alpha = .8, colour="gold2") +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
labs(y="Density",x="Coordinate")
dp
dp<-ggplot(p53.table,aes(start,fill=as.factor(grade),colour=as.factor(grade))) +
geom_density(alpha=.2) +
scale_colour_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
scale_fill_manual(name="",values=c("darkgrey","dodgerblue","green3","indianred","gold2")) +
annotate("point",x = p53.table$start[which(p53.table$grade=="5")], y = 0, alpha = .8, colour="gold2") +
theme_bw(base_size = bs) +
scale_x_continuous(limits = c(start.at,stop.at)) +
labs(y="Density",x="Coordinate")
dp
library(p53retriever)
dim(REs.collection.RData)
dim(REs.collection)
head(REs.collection)
length(unique(REs.collection$ID))
length(unique(REs.collection$HGNC))
dim(REs.collection)
colnames(REs.collection)
REs.collection[1,]
library(p53retriever)
unique(REs.collection$label)
REs.collection<-REs.collection[,1:17]
head(REs.collection)
library(p53retriever)
data(CDKN1A)
p53track(CDKN1A.promoter.seq,seqname="CDKN1A",plot=TRUE)
aa<-p53track(CDKN1A.promoter.seq,seqname="CDKN1A",plot=TRUE)
aa
dim(aa)
library(p53retriever)
class(CDKN1A.promoter.seq)
mode(CDKN1A.promoter.seq)
nchar(CDKN1A.promoter.seq)
load("C:/Users/toma/Dropbox/myR/p53retriever/data/CDKN1A.RData")
library(p53retriever)
data(REs.collection)
dim(REs.collection)
"CDKN1A.promoter.seq"
library(p53retriever)
setwd("C:\\Users\\toma\\Dropbox\\myR\\p53retriever\\data")
CDKN1A<-CDKN1A.promoter.seq
save(CDKN1A,"CDKN1A.RData")
save(CDKN1A,file="CDKN1A.RData")
RE_collection<-REs.collection[,1:17]
head(RE_collection)
save(RE_collection,file="RE_collection.RData")
library(p53retriever)
p53pie(RE_collection,-10000,10000)
p53.table<-RE.collection
p53.table<-RE_collection
summary(p53.table$grade)
summary(as.factor(p53.table$grade))
p53.table$grade<-factor(p53.table$grade,levels=c("1","2","3","4","5"))
summary(p53.table$grade)
table(p53.table$grade)
p53.table$grade<-factor(p53.table$grade,levels=c("1","2","3","4","5"))
dat <- data.frame(count=as.numeric(table(p53.table$grade)), type=names(table(p53.table$grade)))
dat$fraction = dat$count / sum(dat$count)
dat$ymax = cumsum(dat$fraction)
dat$ymin = c(0, head(dat$ymax, n=-1))
dat
p53.table$grade<-factor(p53.table$grade,levels=c("1","2","3","4","5"))
dat <- data.frame(count=as.numeric(table(p53.table$grade)), type=names(table(p53.table$grade)))
dat$fraction = dat$count / sum(dat$count)
dat$ymax = cumsum(dat$fraction)
dat$ymin = c(0, head(dat$ymax, n=-1))
dat$label<-paste(dat$count," (",round(dat$fraction*100,0),"%)",sep="")
dat$label <- factor(dat$label, levels=as.character(dat$label))
color.palette <- c("darkgrey","dodgerblue","green3","indianred","gold2")
dat
pp = ggplot(dat, aes(fill=label, ymax=ymax, ymin=ymin, xmax=4, xmin=2.3)) +
geom_rect(colour="white",alpha=0.9) +
coord_polar(theta="y") +
xlim(c(0, 4)) +
#annotate("text",x=0,y=0.5,label=title,size=bs*0.3, fontface="bold") +
theme_bw(base_size=bs) +
theme(axis.title=element_blank())+
theme(panel.grid=element_blank()) +
theme(axis.text=element_blank()) +
theme(axis.ticks=element_blank()) +
theme(panel.border=element_blank())+
#scale_fill_hue(h=c(90,180),l=c(0,100))
scale_fill_manual(name="Type",values=color.palette)
pp
pp = ggplot(dat, aes(fill=label, ymax=ymax, ymin=ymin, xmax=4, xmin=1)) +
geom_rect(colour="white",alpha=0.9) +
coord_polar(theta="y") +
xlim(c(0, 4)) +
#annotate("text",x=0,y=0.5,label=title,size=bs*0.3, fontface="bold") +
theme_bw(base_size=bs) +
theme(axis.title=element_blank())+
theme(panel.grid=element_blank()) +
theme(axis.text=element_blank()) +
theme(axis.ticks=element_blank()) +
theme(panel.border=element_blank())+
#scale_fill_hue(h=c(90,180),l=c(0,100))
scale_fill_manual(name="Type",values=color.palette)
pp
pp = ggplot(dat, aes(fill=label, ymax=ymax, ymin=ymin, xmax=4, xmin=0)) +
geom_rect(colour="white",alpha=0.9) +
coord_polar(theta="y") +
xlim(c(0, 4)) +
#annotate("text",x=0,y=0.5,label=title,size=bs*0.3, fontface="bold") +
theme_bw(base_size=bs) +
theme(axis.title=element_blank())+
theme(panel.grid=element_blank()) +
theme(axis.text=element_blank()) +
theme(axis.ticks=element_blank()) +
theme(panel.border=element_blank())+
#scale_fill_hue(h=c(90,180),l=c(0,100))
scale_fill_manual(name="Type",values=color.palette)
pp
p53.table<-RE_collection[1:50,]
p53.table$grade<-factor(p53.table$grade,levels=c("1","2","3","4","5"))
dat <- data.frame(count=as.numeric(table(p53.table$grade)), type=names(table(p53.table$grade)))
dat
p53.table$grade<-factor(p53.table$grade,levels=c("1","2","3","4","5"))
dat <- data.frame(count=as.numeric(table(p53.table$grade)), type=names(table(p53.table$grade)))
dat$fraction = dat$count / sum(dat$count)
dat$ymax = cumsum(dat$fraction)
dat$ymin = c(0, head(dat$ymax, n=-1))
dat$label<-paste(dat$count," (",round(dat$fraction*100,0),"%)",sep="")
dat$label <- factor(dat$label, levels=as.character(dat$label))
color.palette <- c("darkgrey","dodgerblue","green3","indianred","gold2")
pp = ggplot(dat, aes(fill=label, ymax=ymax, ymin=ymin, xmax=4, xmin=0)) +
geom_rect(colour="white",alpha=0.9) +
coord_polar(theta="y") +
xlim(c(0, 4)) +
#annotate("text",x=0,y=0.5,label=title,size=bs*0.3, fontface="bold") +
theme_bw(base_size=bs) +
theme(axis.title=element_blank())+
theme(panel.grid=element_blank()) +
theme(axis.text=element_blank()) +
theme(axis.ticks=element_blank()) +
theme(panel.border=element_blank())+
#scale_fill_hue(h=c(90,180),l=c(0,100))
scale_fill_manual(name="Type",values=color.palette)
pp
p53.table$grade<-factor(p53.table$grade,levels=c("1","2","3","4","5"))
dat <- data.frame(count=as.numeric(table(p53.table$grade)), type=c("unlikely","poor","slight","moderate","high"))
dat$fraction = dat$count / sum(dat$count)
dat$ymax = cumsum(dat$fraction)
dat$ymin = c(0, head(dat$ymax, n=-1))
dat$label<-paste(dat$count," (",round(dat$fraction*100,0),"%)",sep="")
dat$label <- factor(dat$label, levels=as.character(dat$label))
color.palette <- c("darkgrey","dodgerblue","green3","indianred","gold2")
pp = ggplot(dat, aes(fill=label, ymax=ymax, ymin=ymin, xmax=4, xmin=0)) +
geom_rect(colour="white",alpha=0.9) +
coord_polar(theta="y") +
xlim(c(0, 4)) +
#annotate("text",x=0,y=0.5,label=title,size=bs*0.3, fontface="bold") +
theme_bw(base_size=bs) +
theme(axis.title=element_blank())+
theme(panel.grid=element_blank()) +
theme(axis.text=element_blank()) +
theme(axis.ticks=element_blank()) +
theme(panel.border=element_blank())+
#scale_fill_hue(h=c(90,180),l=c(0,100))
scale_fill_manual(name="Grade",values=color.palette)
pp
p53.table$grade<-factor(p53.table$grade,levels=c("1","2","3","4","5"))
dat <- data.frame(count=as.numeric(table(p53.table$grade)), type=c("unlikely","poor","slight","moderate","high"))
dat$fraction = dat$count / sum(dat$count)
dat$ymax = cumsum(dat$fraction)
dat$ymin = c(0, head(dat$ymax, n=-1))
dat$label<-paste(dat$count," ",dat$type," (",round(dat$fraction*100,0),"%)",sep="")
dat$label <- factor(dat$label, levels=as.character(dat$label))
color.palette <- c("darkgrey","dodgerblue","green3","indianred","gold2")
pp = ggplot(dat, aes(fill=label, ymax=ymax, ymin=ymin, xmax=4, xmin=0)) +
geom_rect(colour="white",alpha=0.9) +
coord_polar(theta="y") +
xlim(c(0, 4)) +
#annotate("text",x=0,y=0.5,label=title,size=bs*0.3, fontface="bold") +
theme_bw(base_size=bs) +
theme(axis.title=element_blank())+
theme(panel.grid=element_blank()) +
theme(axis.text=element_blank()) +
theme(axis.ticks=element_blank()) +
theme(panel.border=element_blank())+
#scale_fill_hue(h=c(90,180),l=c(0,100))
scale_fill_manual(name="Grade",values=color.palette)
pp
p53pie<-function(p53.table,start.at,stop.at){
p53.table<-p53.table[which(p53.table$start>start.at & p53.table$stop<stop.at),]
p53.table$grade<-factor(p53.table$grade,levels=c("1","2","3","4","5"))
dat <- data.frame(count=as.numeric(table(p53.table$grade)), type=c("unlikely","poor","slight","moderate","high"))
dat$fraction = dat$count / sum(dat$count)
dat$ymax = cumsum(dat$fraction)
dat$ymin = c(0, head(dat$ymax, n=-1))
dat$label<-paste(dat$count," ",dat$type," (",round(dat$fraction*100,0),"%)",sep="")
dat$label <- factor(dat$label, levels=as.character(dat$label))
color.palette <- c("darkgrey","dodgerblue","green3","indianred","gold2")
bs<-16
pp = ggplot(dat, aes(fill=label, ymax=ymax, ymin=ymin, xmax=4, xmin=0)) +
geom_rect(colour="white",alpha=0.9) +
coord_polar(theta="y") +
xlim(c(0, 4)) +
#annotate("text",x=0,y=0.5,label=title,size=bs*0.3, fontface="bold") +
theme_bw(base_size=bs) +
theme(axis.title=element_blank())+
theme(panel.grid=element_blank()) +
theme(axis.text=element_blank()) +
theme(axis.ticks=element_blank()) +
theme(panel.border=element_blank())+
#scale_fill_hue(h=c(90,180),l=c(0,100))
scale_fill_manual(name="Grade",values=color.palette)
return(pp)
}
p53pie(RE_collection,-10000,10000)
p53pie<-function(p53.table,start.at,stop.at){
p53.table<-p53.table[which(p53.table$start>start.at & p53.table$stop<stop.at),]
p53.table$grade<-factor(p53.table$grade,levels=c("1","2","3","4","5"))
dat <- data.frame(count=as.numeric(table(p53.table$grade)), type=c("unlikely","poor","slight","moderate","high"))
dat$fraction = dat$count / sum(dat$count)
dat$ymax = cumsum(dat$fraction)
dat$ymin = c(0, head(dat$ymax, n=-1))
dat$label<-paste(dat$count," ",dat$type," (",round(dat$fraction*100,1),"%)",sep="")
dat$label <- factor(dat$label, levels=as.character(dat$label))
color.palette <- c("darkgrey","dodgerblue","green3","indianred","gold2")
bs<-16
pp = ggplot(dat, aes(fill=label, ymax=ymax, ymin=ymin, xmax=4, xmin=0)) +
geom_rect(colour="white",alpha=0.9) +
coord_polar(theta="y") +
xlim(c(0, 4)) +
#annotate("text",x=0,y=0.5,label=title,size=bs*0.3, fontface="bold") +
theme_bw(base_size=bs) +
theme(axis.title=element_blank())+
theme(panel.grid=element_blank()) +
theme(axis.text=element_blank()) +
theme(axis.ticks=element_blank()) +
theme(panel.border=element_blank())+
#scale_fill_hue(h=c(90,180),l=c(0,100))
scale_fill_manual(name="Grade",values=color.palette)
return(pp)
}
p53pie(RE_collection,-10000,10000)
library(p53retriever)
